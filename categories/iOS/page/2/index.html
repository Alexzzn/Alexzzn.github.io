<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8" >
    <meta name="baidu-site-verification" content="dIcXMeY8Ya" />
    
    <title>`iOS`分类下的文章 | MyBlog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" >
    <meta name="keywords" content="Jelon, 前端, Web, 张德龙, 前端开发" >
    <meta name="description" content="Jelon个人前端小站" >

    
    <link rel="alternative" href="/atom.xml" title="MyBlog" type="application/atom+xml" >
    
    
    <link rel="shortcut icon" href="/favicon.ico" >
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>

<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">MyBlog</span>
                    <span class="description">博客</span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/categories/iOS/page/2/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/categories/iOS/page/2/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/categories/iOS/page/2/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/categories/iOS/page/2/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/jangdelong" target="_blank">Github</a>
                        |
                    
                        <a href="https://pages.coding.me" target="_blank">Hosted by Coding Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                        <a href="http://weibo.com/jangdelong" class="sinaweibo" target="_blank"><b>■</b> 新浪微博</a>
                    
                        <a href="https://www.facebook.com/profile.php?id=100011855760219&amp;ref=bookmarks" class="qqweibo" target="_blank"><b>■</b> Facebook</a>
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="Jelon" >
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 文章分类 -->

    <h3 class="widget-hd">
        <strong>
            
                `iOS`分类下的文章
            
        </strong>
    </h3>
    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/Block_OC_1/">
    		Block_OC_1
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T10:10:21.181Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h4 id="mongoDb常用语句"><a href="#mongoDb常用语句" class="headerlink" title="mongoDb常用语句"></a>mongoDb常用语句</h4><p>本文来自台湾的某开发人员的博客，被墙，感觉讲的比较易懂，所以引过来。文字简体化了，原来是繁体，变数=变量，这个注意一下。</p>
<p>本文的顺序是层层深入的，要想简单的了解，只看X.1 初探Block就好了</p>
<p>本章学习目标：</p>
<blockquote>
<p>\1. 了解何谓block。</p>
<p>\2. 了解block的使用方法。</p>
<p>Block 是iOS在4.0之后新增的程式语法，严格来说block的概念并不算是基础程式设计的范围，对初学者来说也不是很容易了解，但是在iOS SDK 4.0之后，block几乎出现在所有新版的API之中，换句话说，如果不了解block这个概念就无法使用SDK 4.0版本以后的新功能，因此虽然block本身的语法有点难度，但为了使用iOS的新功能我们还是得硬着头皮去了解这个新的程式概念。</p>
<p>在这一章的目标以了解如何使用block为主而不深入探讨block底层的运作方式，至于有些初学者较少遇到的辞汇如「词法作用域（lexical scope）」等，本章将不再多做解释，待有兴趣的读者去请教Google大神吧。</p>
</blockquote>
<p>X.1 初探Block</p>
<p>在这一小节我们先用一些简单范例来导入block的概念。</p>
<blockquote>
<p>X.1.1 宣告和使用Block</p>
<p>我们使用「^」运算子来宣告一个block变数，而且在block的定义最后面要加上「;」来表示一个完整的述句（也就是将整个block定义视为前面章节所介绍的简单述句，因为整个定义必须是一个完整的句子，所以必须在最后面加上分号），下面是一个block的范例：</p>
</blockquote>
<p>   1:int multiplier = 7 ;<br>   2:int (^myBlock)( int ) = ^( int num)<br>   3: {<br>   4:return num * multiplier;<br>   5: };</p>
<blockquote>
<p>我们使用下图来解释这个范例(请将文字框的字翻译如下)：<br>我们宣告一个「myBlock」变数，用「^」符号来表示这是一个block。<br>这是block的完整定义，这个定义将会指定给「myBlock」变数<br>表示「myBlock」是一个回传值为整数（int）的block。<br>它有一个参数，型态也是整数。<br>这个参数的名字叫做「num」。<br>这是block的内容。<br>值得注意的地方是block可以使用和本身定义范围相同的变数，可以想像在上面的例子中 multiplier 和 myBlock 都是某一个函数内定义的两个变数也就是这个变数都在某个函数两个大括号「{」和「 }」中间的区块，因为它们的有效范围是相同的，因此在block中就可以直接使用 multiplier 这个变数，此外当把block定义成一个变数的时，我们可以直接像使用一般函数般的方式使用它：<br>objective-c<br>   1:int multiplier = 7 ;<br>   2:int (^myBlock)( int ) = ^( int num)<br>   3: {<br>   4:return num * multiplier;<br>   5: };<br>   6: printf ( “%d” , myBlock( 3 ));X.1.2 直接使用Bloc</p>
</blockquote>
<blockquote>
<p>K在很多情况下，我们并不需要将block宣告成变数，反之我们可以直接在需要使用block的地方直接用内嵌的方式将block的内容写出来，在下面的例子中qsort_b函数，这是一个类似传统的qsort_t函数，但是直接使用block做为它的参数：<br>objective-c<br>   1:char <em>myCharacters[ 3 ] = { “TomJohn” , “George” , “Charles Condomine” };<br>   2: qsort_b (myCharacters, 3 ,<br>   3:sizeof ( char </em>),<br>   4:          ^( constvoid <em>l, constvoid </em>r)//block部分<br>   5:             {<br>   6:char <em>left = </em>( char <strong>)l;<br>   7:char <em>right = </em>( char </strong>)r;<br>   8:return strncmp (left, right, 1 );<br>   9:             }                            //end<br>  10: );</p>
</blockquote>
<blockquote>
<p>X.1.3 __block 变量</p>
<p>一般来说，在block内只能读取在同一个作用域的变数而且没有办法修改在block外定义的任何变数，此时若我们想要这些变数能够在block中被修改，就必须在前面挂上<strong>block的修饰词，以上面第一个例子中的 multiplier 来说，这个变数在 block 中是唯读的，所以 multiplier = 7 指定完后，在 block 中的 multiplier 就只能是 7 不能修改，若我们在 block 中修改 multiplier ，在编辑时就会产生错误，因此若想要在 block 中修改 multiplier ，就必须在 multiplier 前面加上 </strong>block 的修饰词，请参考下面的范例：<br>objective-c<br>    __block int multiplier = 7 ;<br>    int (^myBlock)( int ) = ^( int num) {<br>        if (num &gt; 5 ) {<br>        multiplier = 7<br>    } else {<br>        multiplier =5<br>    }</p>
</blockquote>
<p>  return num * multiplier;<br>};</p>
<p>X.2 Block 概要</p>
<p>Block 提供我们一种能够将函数程式码内嵌在一般述句中的方法，在其他语言中也有类似的概念称做「closure」，但是为了配合Objective-C的贯例，我们一律将这种用法称为「block」</p>
<blockquote>
<p>X.2.1 Block 的功能</p>
<p>Block 是一种具有匿名功能的内嵌函数，它的特性如下：</p>
<p>如一般的函数般能拥有带有型态的参数。</p>
<p>拥有回传值。</p>
<p>可以撷取被定义的词法作用域（lexical scope）状态。</p>
<p>可以选择性地修改词法作用域的状态。</p>
<p>注：词法作用域（lexical scope）可以想像成是某个函数两个大括号中间的区块，这个区块在程式执行时，系统会将这个区块放入堆叠记忆体中，在这个区块中的宣告的变数就像是我们常听到的区域变数，当我们说block可以撷取同一词法作用域的状态时可以想像block变数和其他区域变数是同一个层级的区域变数（位于同一层的堆叠里），而block的内容可以读取到和他同一层级的其他区域变数。</p>
<p>我们可以拷贝一个block，也可以将它丢到其他的执行绪中使用，基本上虽然block在iOS程式开发中可以使用在C/C++开发的程式片段，也可以在Objective-C中使用，不过在系统的定义上，block永远会被视为是一个Objective-C的物件。</p>
<p>X.2.2 Block 的使用时机</p>
<p>Block 一般是用来表示、简化一小段的程式码，它特别适合用来建立一些同步执行的程式片段、封装一些小型的工作或是用来做为某一个工作完成时的回传呼叫（callback） 。</p>
<p>在新的iOS API中block被大量用来取代传统的delegate和callback，而新的API会大量使用block主要是基于以下两个原因：</p>
<p>可以直接在程式码中撰写等会要接着执行的程式，直接将程式码变成函数的参数传入函数中，这是新API最常使用block的地方。</p>
<p>可以存取区域变数，在传统的callback实作时，若想要存取区域变数得将变数封装成结构才能使用，而block则是可以很方便地直接存取区域变数。</p>
</blockquote>
<p>X.3 宣告和建立Block</p>
<blockquote>
<p>X.3.1 宣告Block的参考（Reference）</p>
<p>Block 变数储存的是一个block的参考，我们使用类似宣告指标的方式来宣告，不同的是这时block变数指到的地方是一个函数，而指标使用的是「<em>」，block则是使用「^」来宣告，下面是一些合法的block宣告：<br>objective-c<br>   1:/</em> 回传void ，参数也是void 的block*/<br>   2:void (^blockReturningVoidWithVoidArgument)( void );</p>
</blockquote>
<p>   3:/<em> 回传整数，两个参数分别是整数和字元型态的block</em>/</p>
<p>   4:int   (^blockReturningIntWithIntAndCharArguments)( int , char );</p>
<p>   5:/<em> 回传void ，含有10 个block 的阵列，每个block 都有一个型态为整数的参数</em>/</p>
<p>   6:void (^arrayOfTenBlocksReturningVoidWinIntArgument[ 10 ])( int );</p>
<p>   7: X.3.2 建立一个Block<br>   8:<br>   9: 我们使用「^」来开始一个block，并在最后使用「;」来表示结束，下面的范例示范了一个block变数，然后再定义一个block把它指定给block变数： </p>
<p>  10:</p>
<p>  11:int (^oneFrom)( int ); /<em> 宣告block 变数</em>/<br>  12:/<em> 定义block 的内容并指定给上面宣告的变数</em>/objective-c<br>  13:     oneFrom = ^(int anInt)</p>
<p>  14:                 {</p>
<p>  15:return anInt = - 1 ; </p>
<p>  16:                 };</p>
<blockquote>
<p>X.3.3 全域的Block</p>
<p>我在可以在档案中宣告一个全域的block，请参考以下范例：</p>
</blockquote>
<p>   1:int GlobalInt = 0 ;</p>
<p>   2:int (^getGlobalInt)( void ) = ^ ( void ) { return GlobalInt ;};</p>
<p>X.4 Block 和变量</p>
<p>接下来的这一小节我们将会介绍block和变数之间的互动。</p>
<blockquote>
<p>X.4.1 变数的型态</p>
<p>我们可以在block中遇到平常在函数中会遇到的变数类型：</p>
<p>l 全域（global）变数或是静态的区域变数（static local）。</p>
<p>l 全域的函数。</p>
<p>l 区域变数和由封闭领域（enclosing scope）传入的参数。</p>
<p>除了上述之外block额外支援了另外两种变数：</p>
<p>在函数内可以使用__block 变数，这些变数在block中是可被修改的。</p>
<p>汇入常数（const imports）。</p>
<p>此外，在方法的实作里，block可以使用Objective-C的实体变数（instance variable）。</p>
<p>下列的规则可以套用到在block中变数的使用：</p>
<p>可以存取全域变数和在同一领域（enclosing lexical scope）中的静态变数。</p>
<p>可以存取传入block的参数（使用方式和传入函数的参数相同）。</p>
<p>在同一领域的区域变数在block中将视为常数（const）。</p>
<p>可以存取在同一领域中以__block 为修饰词的变数。</p>
<p>在block中宣告的区域变数，使用方式和平常函数使用区域变数的方式相同。</p>
<p>下面的例子介绍了区域变数（上述第三点）的使用方式：</p>
</blockquote>
<p>   1:int x = 123 ;</p>
<p>   2:void (^printXAndY)( int ) = ^( int y)</p>
<p>   3:     {</p>
<p>   4: printf ( “%d %d\n” , x, y); </p>
<p>   5:     };</p>
<p>   6:// 将会印出123 456</p>
<p>   7:     printXAndY( 456 );</p>
<p>   8: 就如上面第三点所提到的，在上例中的int x = 123的变量x，在传入block后将视同常数，因此若我们在block中试着去修改x的值时就会产生错误，下面的例子将会无法通过编译： </p>
<p>   9:</p>
<p>  10:int x = 123 ;</p>
<p>  11:void (^printXAndY)( int ) = ^( int y)</p>
<p>  12: {</p>
<p>  13:// 下面这一行是错的，因为x 在这是一个常数不能被修改。</p>
<p>  14:     x = x + y;</p>
<p>  15:     printf ( “%d %d\n” , x, y); </p>
<p>  16:     };</p>
<blockquote>
<p>若在block中想要修改上面的变数x，必须将x宣告加上修饰词__block，请参考接下来这一小节的介绍。</p>
<p>X.4.2 __block 型态变数</p>
<p>我们可以藉由将一个由外部汇入block的变数放上修饰词<strong>block来让这个变数由唯读变成可以读和写，不过有一个限制就是传入的变数在记忆体中必须是一个占有固定长度记忆体的变数，</strong>block修饰词无法使用于像是变动长度的阵列这类不定长度的变数，请参考下面的范例：</p>
</blockquote>
<p>   1:// 加上__block 修饰词，所以可以在block 中被修改。</p>
<p>   2: __block int x = 123 ;</p>
<p>   3:void (^printXAndY)( int ) = ^( int y)</p>
<p>   4:     {</p>
<p>   5:         x = x + y; </p>
<p>   6: printf ( “%d %d\n” , x, y); </p>
<p>   7:     };</p>
<p>   8:// 将会印出579 456</p>
<p>   9:     printXAndY( 456 );</p>
<p>  10://x 将会变成　579;</p>
<p>  11: 下面我们使用一个范例来介绍各类型的变数和block之间的互动： </p>
<p>  12:</p>
<p>  13:extern NSInteger CounterGlobal;</p>
<p>  14:static NSInteger CounterStatic;</p>
<p>  15: {</p>
<p>  16: NSInteger localCounter = 42 ;</p>
<p>  17: __block char localCharacter;</p>
<p>  18:void (^aBlock)( void ) = ^( void )</p>
<p>  19:     {</p>
<p>  20:         ++ CounterGlobal ; //可以存取。</p>
<p>  21:         ++ CounterStatic ; //可以存取。　</p>
<p>  22: CounterGlobal = localCounter; //localCounter在block 建立时就不可变了。</p>
<p>  23:         localCharacter = ‘a’ ; //设定外面定义的localCharacter 变数。</p>
<p>  24:     };</p>
<p>  25:     ++localCounter; //不会影响的block 中的值。</p>
<p>  26:     localCharacter = ‘b’ ;</p>
<p>  27:     aBlock(); //执行block 的内容。</p>
<p>  28://执行完后，localCharachter 会变成’a’</p>
<p>  29: }</p>
<blockquote>
<p>X.4.3 物件和Block变数</p>
<p>Block 支援在Objective-C、C++物件和其他block中当作变数来使用，不过因为在大部分的情况我们都是使用Objective-C的撰写程式，因此在这一小节我们仅针对Objective-C的情况进行介绍，至于其他两种情况就留给有兴趣的读者再自行深入研究了。</p>
<p>x.4.3.1 Objective-C 物件</p>
<p>在拥有参考计数（reference-counted）的环境中，若我们在block中参考到Objective-C的物件，在一般的情况下它将会自动增加物件的参考计数，不过若以__block为修饰词的物件，参考计数则是不受影响。</p>
<p>如果我们在Objective-C的方法中使用block时，以下几个和记忆体管理的事是需要额外注意的：</p>
<p>l 若直接存取实体变数（instance variable），self的参考计数将被加1。</p>
<p>l 若透过变数存取实体变数的值，则只变数的参考计数将被加1。</p>
<p>以下程式码说明上面两种情况，在这个假设instanceVariable是实体变数：</p>
</blockquote>
<p>   1: dispatch_async (queue, ^{</p>
<p>   2:// 因为直接存取实体变数instanceVariable ，所以self 的retain count 会加１</p>
<p>   3: doSomethingWithObject (instanceVariable);</p>
<p>   4:     });</p>
<p>   5: id localVaribale = instanceVariable;</p>
<p>   6: dispatch_async (queue, ^{</p>
<p>   7://localVariable 是存取值，所以这时只有localVariable 的retain count 加１</p>
<p>   8://self 的　return count 　并不会增加。</p>
<p>   9: doSomethingWithObject (localVaribale);</p>
<p>  10:     });</p>
<p>X.5 使用Block</p>
<p>这一小节我们将会对block的使用方式做一些初步的介绍</p>
<blockquote>
<p>X.5.1 呼叫一个Block</p>
<p>当block宣告成一个变数时，我们可以像使用一般函数的方式来使用它，请参考下面两个范例：</p>
</blockquote>
<p>   1:int (^oneFrom)( int ) = ^( int anInt) {</p>
<p>   2:return anInt - 1 ;</p>
<p>   3:     };</p>
<p>   4: printf ( “1 from 10 is %d” , oneFrom( 10 ));</p>
<p>   5://结果会显示：1 from 10 is 9</p>
<p>   6:float (^distanceTraveled)( float , float , float ) = ^( float startingSpeed, float acceleration, float time)</p>
<p>   7:     {</p>
<p>   8:float distance = (startingSpeed <em> time) + ( 0.5 </em> acceleration <em> time </em> time);</p>
<p>   9:return distance;</p>
<p>  10:     };</p>
<p>  11:float howFar = distanceTraveled( 0.0 , 9.8 , 1.0 );</p>
<p>  12: //howFar会变成4.9</p>
<blockquote>
<p>在一般常见的情况中，若是将block当做是参数传入函数，我们通常会使用「内嵌」的方式来使用block。</p>
<p>X.5.2 将Block当作函数的参数</p>
<p>我们可以像使用一般函数使用参数的方式，将block以函数参数的型式传入函数中，在这种情况下，大多数我们使用block的方式将不会倾向宣告block而是直接以内嵌的方式来将block传入，这也是目前新版SDK中主流的做法，我们将补充前面章节的例子来说明：</p>
</blockquote>
<p>   1:char *myCharacters[ 3 ] = { “TomJohn” , “George” , “Charles Condomine” };</p>
<p>   2: qsort_b (myCharacters, 3 , sizeof ( char *),</p>
<p>   3:             ^( constvoid <em>l, constvoid </em>r)</p>
<p>   4:             {</p>
<p>   5:char <em>left = </em>( char **)l;</p>
<p>   6:char <em>right = </em>( char **)r;</p>
<p>   7:return strncmp (left, right, 1 );</p>
<p>   8:             } // 这里是block 的终点。</p>
<p>   9:             );</p>
<p>  10: // 最后的结果为：{“Charles Condomine”, “George”, “TomJohn”}</p>
<blockquote>
<p>在上面的例子中，block本身就是函数参数的一部分，在下一个例子中dispatch_apply函数中使用block，dispatch_apply的定义如下：</p>
</blockquote>
<p>   1:void</p>
<p>   2: dispatch_apply( size_t iterations, dispatch_queue_t queue, void (^block)( size_t ));</p>
<p>   3: 这个函数将一个block提交到发送伫列（dispatch queue）中来执行多重的呼叫，只有当伫列中的工作都执行完成后才会回传，这个函数拥有三个变数，而最后一个参数就是block ，请参考下面的范例： </p>
<p>   4:</p>
<p>   5: size_t count = 10 ;</p>
<p>   6: dispatch_queue_t queue =</p>
<p>   7: dispatch_get_global_queue ( DISPATCH_QUEUE_PRIORITY_DEFAULT , 0 );</p>
<p>   8: dispatch_apply (count, queue, ^( size_t i) {</p>
<p>   9: printf ( “%u\n” , i);</p>
<p>  10:     });</p>
<blockquote>
<p>X.5.3 将Block当作方法的参数</p>
<p>在SDK中提供了许多使用block的方法，我们可以像传递一般参数的方式来传递block，下面这个范例示范如何在一个阵列的前5笔资料中取出我们想要的资料的索引值：</p>
</blockquote>
<p>   1:// 所有的资料</p>
<p>   2: NSArray *array = [ NSArray arrayWithObjects : @”A” , @”B” , @”C” , @”A” , @”B” , @”Z” , @”G” , @”are” , @” Q” ,nil ];   </p>
<p>   3:// 我们只要这个集合内的资料</p>
<p>   4: NSSet *filterSet = [ NSSet setWithObjects : @”A” , @”B” , @”Z” , @”Q” , nil ];</p>
<p>   5: BOOL (^test)( id obj, NSUInteger idx, BOOL *stop);</p>
<p>   6: test = ^ ( id obj, NSUInteger idx, BOOL *stop) {</p>
<p>   7:// 只对前5 笔资料做检查</p>
<p>   8:if (idx &lt; 5 ) {</p>
<p>   9:if ([filterSet containsObject : obj]) {</p>
<p>  10:return YES ;</p>
<p>  11:               }</p>
<p>  12:       }</p>
<p>  13:return NO ;</p>
<p>  14: };</p>
<p>  15: NSIndexSet *indexes = [array indexesOfObjectsPassingTest :test];</p>
<p>  16: NSLog ( @”indexes: %@” , indexes);   </p>
<p>  17:// 结果：indexes: [number of indexes: 4 (in 2 ranges), indexes: (0-1 3-4)]</p>
<p>  18:// 前５笔资料中，有４笔符合条件，它们的索引值分别是0-1, 3-4</p>
<blockquote>
<p>X.5.4 该避免的使用方式</p>
<p>在下面的例子中，block是for回圈的区域变数因此在使用上必须避免将区域的block指定给外面宣告的block：</p>
</blockquote>
<p>   1:// 这是错误的范例，请勿在程式中使用这些语法!!</p>
<p>   2:void dontDoThis() {</p>
<p>   3:void (^blockArray[3])(void); // 3 个block 的阵列</p>
<p>   4:for (int i = 0; i &lt; 3; ++i) {</p>
<p>   5:         blockArray[i] = ^{ printf(“hello, %d\n”, i); };</p>
<p>   6:// 注意: 这个block 定义仅在for 回圈有效。</p>
<p>   7:     }</p>
<p>   8: }</p>
<p>   9:void dontDoThisEither() {</p>
<p>  10:void (^block)(void);</p>
<p>  11:int i = random():</p>
<p>  12:if (i &gt; 1000) {</p>
<p>  13:         block = ^{ printf(“got i at: %d\n”, i); };</p>
<p>  14:// 注意: 这个block 定义仅在if 后的两个大括号中有效。</p>
<p>  15:     }<br>  16:// …<br>  17: }</p>

            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/Block_OC_1/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/Block_OC_1/" title="Block_OC_1">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/SwiftDate处理/">
    		SwiftDate处理
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T10:10:21.180Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h4 id="swiftdate"><a href="#swiftdate" class="headerlink" title="swiftdate"></a>swiftdate</h4><p><code>`</code>swift<br>        // 获取当前date<br>        let date1 = Date.init()<br>        let data2 = “2015-07-26”.date(format: DateFormat.custom(“yyyy.mm.dd”), fromRegion: Region.Local())<br>        let date3 = DateInRegion.init(components: DateComponents.init(calendar: Calendar.autoupdatingCurrent, timeZone: TimeZone.current, era: 1, year: 2010, month: 1, day: 1, hour: 1, minute: 1, second: 1, nanosecond: 1, weekday: nil))<br>        // dataregion 修改时间元素值<br>        let date4 = date3! + 14.minutes + 12.seconds<br>        // 比较时间<br>        let bv = date3! &gt; date4<br>        // 时间起始值<br>        let date5 = date4.startOf(component: Calendar.Component.hour)<br>        let date6 = date4.endOfDay</p>
<pre><code>// 时间戳
let inter1 = TimeInterval.init(&quot;1244&quot;)!
let date7 = Date.init(timeIntervalSinceNow: inter1)
date7.inLocalRegion()


// 获取多个时间中的最靠前
let date8 = DateInRegion.oldestDate([date5,date6])


// 获取字符串
let date1Str = date1.string(format: DateFormat.custom(&quot;YYYY-MM-DD&quot;), in: Region.Local())
let dateStr1 = data2?.string(dateStyle: DateFormatter.Style.medium, timeStyle: DateFormatter.Style.short)
//
</code></pre>
            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/SwiftDate处理/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/SwiftDate处理/" title="SwiftDate处理">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/swift4 字符串/">
    		swift4 字符串
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T10:10:21.179Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> greeting = <span class="string">"Hello, world!"</span></span><br><span class="line"><span class="keyword">let</span> index = greeting.index(of: <span class="string">","</span>) ?? greeting.endIndex</span><br><span class="line"><span class="keyword">let</span> beginning = greeting[..&lt;index]</span><br><span class="line"><span class="comment">// beginning is "Hello"</span></span><br><span class="line"><span class="comment">//但是注意SubString可能会用到原来string的内存。官方建议是短时间使用，如果想要长时间保持，需要转为String</span></span><br><span class="line"><span class="comment">// Convert the result to a String for long-term storage.</span></span><br><span class="line"><span class="keyword">let</span> newString = <span class="type">String</span>(beginning)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>插入和移除字符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var welcome = &quot;hello&quot;</span><br><span class="line">welcome.insert(&quot;!&quot;, at: welcome.endIndex)</span><br><span class="line">// welcome now equals &quot;hello!&quot;</span><br><span class="line"></span><br><span class="line">welcome.insert(contentsOf: &quot; there&quot;, at: welcome.index(before: welcome.endIndex))</span><br><span class="line">// welcome now equals &quot;hello there!&quot;</span><br><span class="line">welcome.remove(at: welcome.index(before: welcome.endIndex))</span><br><span class="line">// welcome now equals &quot;hello there&quot;</span><br><span class="line"></span><br><span class="line">let range = welcome.index(welcome.endIndex, offsetBy: -6)..&lt;welcome.endIndex</span><br><span class="line">welcome.removeSubrange(range)</span><br><span class="line">// welcome now equals &quot;hello&quot;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>One-sided Slicing<br>Swift 4 新增了一个语法糖 … 可以对字符串进行单侧边界取子串。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//Swift 3:</span><br><span class="line"></span><br><span class="line">let values = &quot;abcdefg&quot;</span><br><span class="line">let startSlicingIndex = values.index(values.startIndex, offsetBy: 3)</span><br><span class="line">let subvalues = values[startSlicingIndex..&lt;values.endIndex] // defg</span><br><span class="line"></span><br><span class="line">//Swift 4:</span><br><span class="line"></span><br><span class="line">let values = &quot;abcdefg&quot;</span><br><span class="line">let startSlicingIndex = values.index(values.startIndex, offsetBy: 3)</span><br><span class="line">let subvalues = values[startSlicingIndex...] // One-sided Slicing // defg</span><br></pre></td></tr></table></figure></p>
</blockquote>

            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/swift4 字符串/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/swift4 字符串/" title="swift4 字符串">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/cocoapods 私有仓库/">
    		cocoapods 私有仓库
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T10:10:20.348Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><a href="https://guides.cocoapods.org/syntax/podspec.html#vendored_frameworks" target="_blank" rel="noopener">官方文档</a></p>
<blockquote>
<p>首先同步git repo 仓库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo add demo www.gitee.demo:jj/xx.git</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>新建私有仓库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod lib create demo</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>查看repo列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo list</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>修改podspec 文件，注意summary，desc，git source 地址<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Pod::Spec.new <span class="keyword">do</span> <span class="params">|s|</span></span><br><span class="line">  s.name             = <span class="string">'ZZNTT'</span></span><br><span class="line">  s.version          = <span class="string">'0.1.1'</span></span><br><span class="line">  s.summary          = <span class="string">'描述文件'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This description is used to generate tags and improve search results.</span></span><br><span class="line"><span class="comment">#   * Think: What does it do? Why did you write it? What is the focus?</span></span><br><span class="line"><span class="comment">#   * Try to keep it short, snappy and to the point.</span></span><br><span class="line"><span class="comment">#   * Write the description between the DESC delimiters below.</span></span><br><span class="line"><span class="comment">#   * Finally, don't worry about the indent, CocoaPods strips it!</span></span><br><span class="line"></span><br><span class="line">  s.description      = <span class="string">&lt;&lt;-DESC</span></span><br><span class="line"><span class="string">  这是一个测试的DEMO</span></span><br><span class="line"><span class="string">                       DESC</span></span><br><span class="line"></span><br><span class="line">  s.homepage         = <span class="string">'https://gitee.com/izhongnan/ZZNTT'</span></span><br><span class="line">  <span class="comment"># s.screenshots     = 'www.example.com/screenshots_1', 'www.example.com/screenshots_2'</span></span><br><span class="line">  s.license          = &#123; <span class="symbol">:type</span> =&gt; <span class="string">'MIT'</span>, <span class="symbol">:file</span> =&gt; <span class="string">'LICENSE'</span> &#125;</span><br><span class="line">  s.author           = &#123; <span class="string">'ZZN'</span> =&gt; <span class="string">'dream_at@live.cn'</span> &#125;</span><br><span class="line">  s.source           = &#123; <span class="symbol">:git</span> =&gt; <span class="string">'https://gitee.com/izhongnan/ZZNTT.git'</span>, <span class="symbol">:tag</span> =&gt; s.version.to_s &#125;</span><br><span class="line">  <span class="comment"># s.social_media_url = 'https://twitter.com/&lt;TWITTER_USERNAME&gt;'</span></span><br><span class="line"></span><br><span class="line">  s.ios.deployment_target = <span class="string">'8.0'</span></span><br><span class="line">  s.requires_arc = <span class="literal">true</span>   </span><br><span class="line">  s.frameworks = <span class="string">'UIKit'</span>  </span><br><span class="line">  s.source_files = <span class="string">'ZZNTT/Classes/**/*'</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># s.resource_bundles = &#123;</span></span><br><span class="line">  <span class="comment">#   'ZZNTT' =&gt; ['ZZNTT/Assets/*.png']</span></span><br><span class="line">  <span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.public_header_files = 'Pod/Classes/**/*.h'</span></span><br><span class="line">  <span class="comment"># s.frameworks = 'UIKit', 'MapKit'</span></span><br><span class="line">  <span class="comment"># s.dependency 'AFNetworking', '~&gt; 2.3'</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>commit 本地私有仓库，加入tag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git add -A</span><br><span class="line">git commit -s -m &quot;Initial Commit of Library&quot;</span><br><span class="line">git remote add origin XXX.git</span><br><span class="line">git push origin master</span><br><span class="line"></span><br><span class="line">git tag 0.1.0</span><br><span class="line">git push --tags</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>验证文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint</span><br><span class="line">pod lib lint --no-clean 查看错误详情</span><br><span class="line">pod lib lint --allow-warnings 允许警告(包括xcode编译的warning)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>向Spec Repo提交podspec<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo push demo(本地repo) demo.podspec</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &apos;demo&apos;, :git =&gt; &apos;www.gitee.demo:jj/xx.git&apos;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>注意问题</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1, swift库注意 SWIFT_VERSION 和 module_name</span><br><span class="line">2, pod spec lint 可以添加--allow-warnings</span><br><span class="line">3, storyboard，xib等资源文件可以打包成bundle后，通过s.resource_bundles引用</span><br><span class="line">4, 库中引用资源等，需要找到当前文件所在的bundle来引用</span><br><span class="line">	let moudleFileBundle = Bundle.init(for: self.classForCoder())</span><br><span class="line">	let img = UIImage.init(named: name, in: moudleFileBundle, compatibleWith: nil)</span><br></pre></td></tr></table></figure>

            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/cocoapods 私有仓库/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/cocoapods 私有仓库/" title="cocoapods 私有仓库">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/web和js交互小结/">
    		web和js交互小结
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T10:10:20.338Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>iOS 7 引入 JSCore， iOS8 后引入WebKit，提供WKScriptMessageHandler</p>
</blockquote>
<ul>
<li>JSContext：给JavaScript提供运行的上下文环境,通过-evaluateScript:方法就可以执行一JS代码</li>
<li>JSValue：封装了JS与ObjC中的对应的类型，以及调用JS的API等</li>
<li>JSManagedValue：管理数据和方法的类</li>
<li>JSVirtualMachine：处理线程相关，使用较少</li>
<li>JSExport：这是一个协议，如果采用协议的方法交互，自己定义的协议必须遵守此协议，在协议中声明的API都会在JS中暴露出来，才能调用</li>
</ul>
<blockquote>
<p>ObjC调用JS</p>
</blockquote>
<ul>
<li>-(JSValue <em>)evaluateScript:(NSString </em>)script;方法就可以执行一段JavaScript脚本</li>
<li>-(JSValue <em>)callWithArguments:(NSArray </em>)arguments;方法可以反过来将参数传进去来调用方法</li>
<li><blockquote>
<p>JS调用OC</p>
</blockquote>
</li>
<li><p>Blcok</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">JSContext *context = [[JSContext alloc] init];</span><br><span class="line">// 定义一个block</span><br><span class="line">context[@&quot;fun1&quot;] = ^() &#123;</span><br><span class="line">               </span><br><span class="line">  NSArray *args = [JSContext currentArguments];</span><br><span class="line">  for (JSValue *jsVal in args) &#123;</span><br><span class="line">   NSLog(@&quot;%@&quot;, jsVal);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  JSValue *this = [JSContext currentThis];</span><br><span class="line">  NSLog(@&quot;this: %@&quot;,this);</span><br><span class="line">&#125;;</span><br><span class="line">// 调用js的fun1方法</span><br><span class="line"> [context evaluateScript:@&quot;fun1(&apos;arr&apos;, [a, b],&#123; a:&apos;b&apos;&#125;);&quot;];</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>建立模型 遵循 jsexport协议</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">MyJSModel</span>:<span class="title">JSExport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// show showAlert</span></span><br><span class="line">	<span class="function"><span class="keyword">func</span> <span class="title">showAlert</span><span class="params">(title:String,msg:String)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyJSModelManger</span>:<span class="title">MyJSModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> context:<span class="type">JSContext</span>?</span><br><span class="line">	<span class="keyword">var</span> webview:<span class="type">WKWebView</span>?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 执行代理方法</span></span><br><span class="line">	<span class="function"><span class="keyword">func</span> <span class="title">showAlert</span><span class="params">(title:String,msg:String)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">debugPrint</span>(title,msg)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注入模型</p>
</blockquote>
<ul>
<li>定义代理协议（声明js要执行的方法）</li>
<li>遵守JSExport协议</li>
<li>实体类(MyJSModelManager)代理此协议(声明变量 JSContext，UIWebView)</li>
<li>注入模型<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">self.jsContext = [webView valueForKeyPath:@&quot;documentView.webView.mainFrame.javaScriptContext&quot;];</span><br><span class="line"></span><br><span class="line">MyJSModelManager *model = [MyJSModelManager new];</span><br><span class="line">self.jsContext[@&quot;mymodel&quot;] = model;</span><br><span class="line">model.jsContext = self.jsContext;</span><br><span class="line">model.webView = self.webView;</span><br><span class="line"> // 异常</span><br><span class="line"> self.jsContext.exceptionHandler =^(JSContext *context,JSValue *exceptionValue) &#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>web端调用</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// html5</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin-top: 100px"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>JsToNative/h1&gt; </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"show"</span> <span class="attr">onclick</span>=<span class="string">"mymodel.showAlert()"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/web和js交互小结/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/web和js交互小结/" title="web和js交互小结">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/GCD/">
    		GCD
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T09:57:26.489Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><code>`</code>swift<br> //  后台执行：<br> dispatch_async(dispatch_get_global_queue(0, 0), ^{<br>      // something<br> });</p>
<p> // 主线程执行：<br> dispatch_async(dispatch_get_main_queue(), ^{<br>      // something<br> });</p>
<p> // 一次性执行：<br> static dispatch_once_t onceToken;<br> dispatch_once(&amp;onceToken, ^{<br>     // code to be executed once<br> });</p>
<p> // 延迟2秒执行：<br> double delayInSeconds = 2.0;<br> dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);<br> dispatch_after(popTime, dispatch_get_main_queue(), ^(void){<br>     // code to be executed on the main queue after delay<br> });</p>
<p> // 自定义dispatch_queue_t<br> dispatch_queue_t urls_queue = dispatch_queue_create(“blog.devtang.com”, NULL);<br> dispatch_async(urls_queue, ^{<br>　 　// your code<br> });<br> dispatch_release(urls_queue);</p>
<p> // 合并汇总结果<br> dispatch_group_t group = dispatch_group_create();<br> dispatch_group_async(group, dispatch_get_global_queue(0,0), ^{<br>      // 并行执行的线程一<br> });<br> dispatch_group_async(group, dispatch_get_global_queue(0,0), ^{<br>      // 并行执行的线程二<br> });<br> dispatch_group_notify(group, dispatch_get_global_queue(0,0), ^{<br>      // 汇总结果<br> });</p>

            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/GCD/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/GCD/" title="GCD">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/NSLOCATION/">
    		NSLOCATION
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T09:57:26.488Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>调用 core loaction 中的 CLLocationManager</p>
<p>#import &lt;CoreLocation/CoreLocation.h&gt;<br>CLLocationManager *locationManager;</p>
<p>在定位服务中还包含CLGeocoder类用于处理地理编码和逆地理编码（又叫反地理编码）功能。</p>
<p>CLGeocoder *_geocoder;<br>对象方法:reverseGeocodeLocation:location completionHandler: </p>
<p>类方法 :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+ (BOOL)locationServicesEnabled;获取是否开启定位服务</span><br><span class="line">+ (CLAuthorizationStatus)authorizationStatus; 返回 用户 的操作 的枚举</span><br><span class="line">属性</span><br><span class="line">desiredAccuracy :定位精度的枚举</span><br><span class="line"></span><br><span class="line">对象方法:</span><br><span class="line">startUpdatingLocation:开始定位追踪，开始定位后将按照用户设置的更新频率执行</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations;</span><br><span class="line">方法反馈定位信息</span><br><span class="line"></span><br><span class="line">stopUpdatingLocation:停止定位追踪</span><br><span class="line"></span><br><span class="line">requestAlwaysAuthorization:请求获得应用一直使用定位服务授权，</span><br><span class="line">注意使用此方法前要在info.plist中配置NSLocationAlwaysUsageDescription</span><br></pre></td></tr></table></figure>
            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/NSLOCATION/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/NSLOCATION/" title="NSLOCATION">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/浅谈iOS导航栏布局问题/">
    		浅谈iOS导航栏布局问题
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T09:57:26.486Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h4 id="iOS-安全区域"><a href="#iOS-安全区域" class="headerlink" title="iOS 安全区域"></a>iOS 安全区域</h4><blockquote>
<p><strong><em>主要设计几个属性 automaticallyAdjustsScrollViewInsets，contentInsetAdjustmentBehavior,adjustedContentInset,edgesForExtendedLayout</em></strong></p>
<p>iOS11 安全区域后由topLayoutGuider 改为 safeGuider作为相对依赖<br>导航栏透明属性后，scrollview属性的view push是 会由控制器 automaticallyAdjustsScrollViewInsets(iOS10),adjustedContentInset(iOS11) 自动加上 nav的高度，</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通控制器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">initLayoutUI</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 禁用系统滚动视图布局 ios10</span></span><br><span class="line">        automaticallyAdjustsScrollViewInsets = <span class="literal">false</span></span><br><span class="line">        <span class="comment">// 布局</span></span><br><span class="line">        contentView.snp.makeConstraints &#123; (make) <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> #available(iOS <span class="number">11.0</span>, *) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> navBgBarTransEnable == <span class="literal">true</span> &#123;</span><br><span class="line"></span><br><span class="line">                    make.top.bottom.equalTo(<span class="number">0</span>)</span><br><span class="line">                    edgesForExtendedLayout = .top</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    make.top.equalTo(view.safeAreaLayoutGuide.snp.top)</span><br><span class="line">                    make.bottom.equalTo(view.safeAreaLayoutGuide.snp.bottom)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> navBgBarTransEnable == <span class="literal">true</span> &#123;</span><br><span class="line"></span><br><span class="line">                    edgesForExtendedLayout = .top</span><br><span class="line">                    make.top.bottom.equalToSuperview()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    make.top.equalTo(topLayoutGuide.snp.bottom)</span><br><span class="line">                    make.bottom.equalTo(bottomLayoutGuide.snp.top)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            make.<span class="keyword">left</span>.<span class="keyword">right</span>.equalToSuperview()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// tablevivew</span></span><br><span class="line">        <span class="keyword">if</span> #available(iOS <span class="number">11</span>, *) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> navBgBarTransEnable == <span class="literal">true</span> &#123;</span><br><span class="line"></span><br><span class="line">                tableView.contentInsetAdjustmentBehavior = .never</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                tableView.contentInsetAdjustmentBehavior = .automatic</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//tableView.contentInsetAdjustmentBehavior = .automatic</span></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> navBgBarTransEnable == <span class="literal">true</span> &#123;</span><br><span class="line"></span><br><span class="line">                automaticallyAdjustsScrollViewInsets = <span class="literal">false</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                automaticallyAdjustsScrollViewInsets = <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/浅谈iOS导航栏布局问题/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/浅谈iOS导航栏布局问题/" title="浅谈iOS导航栏布局问题">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/iOS进阶学习/">
    		iOS进阶学习
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T09:57:26.484Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h4 id="git-回顾"><a href="#git-回顾" class="headerlink" title="git 回顾"></a>git 回顾</h4><ul>
<li>初始化<code>git init</code></li>
<li>添加文件 <code>git add *</code></li>
<li>提交<code>git commit -m desc</code></li>
<li>查看记录 <code>git log</code></li>
<li>版本回退 <code>git reset --hard HEAD^^</code>  <code>^表示上一个版本，^^表示上上个, ~表示第几个，34356表示id号 * --hard id</code></li>
<li>版本恢复查看 <code>git reflog</code> 查看已删除 commit id</li>
<li>添加远程仓库 <code>git remote add origin git@xx.git</code> </li>
<li>修改远程仓库地址 <code>git remote set-url origin git@xx.git</code></li>
<li>push仓库 <code>git push -u origin master</code></li>
<li>tag标签 <code>git tag -m &#39;**&#39;</code> 同步 <code>git push origin 0.02</code>  删除 <code>git push origin :版本号</code></li>
<li></li>
</ul>
<ul>
<li><p>初级工程师<br>精通oc语言基础<br>精通UIKit<br>熟悉网络通信机制以及常用数据传输协议<br>具备主流开源框架的使用经验（AFNetWorking）</p>
</li>
<li><p>中级工程师技术要求<br>扎实的编程，数据结构，算法基础<br>深入理解语言机制，内存管理，网路，多线程，gui<br>精通常用的设计模式，框架，构架<br>良好的分析，解决问题的能力</p>
</li>
<li><p>高级工程师的技术要求<br>解决研发过程中的关键问题和技术难题<br>调优设备流量，性能，电量等<br>较强的软件设计能力<br>对iOS内部原理有深刻的理解</p>
</li>
</ul>
<h4 id="tableview-要点"><a href="#tableview-要点" class="headerlink" title="tableview 要点"></a>tableview 要点</h4><ul>
<li>cell复用</li>
<li>数据源同步（多线程并发 修改读写数据源）（解决：串行|copy）</li>
</ul>
<h4 id="UI事件传递响应"><a href="#UI事件传递响应" class="headerlink" title="UI事件传递响应"></a>UI事件传递响应</h4><ul>
<li><p>uiview，calayer</p>
<blockquote>
<p>uiview -&gt; layer(calayer,(contents-&gt;backing store)) -&gt; backgoundcolor(层级关系) </p>
<p>总结: UIView 是提供显示内容，以及处理触等事件以及参与响应链，CAlayer负责显示视图内容等contents</p>
</blockquote>
</li>
<li><p>事件传递、响应链</p>
<blockquote>
<p>主要有两个方法参与： hitTest(point:CGPoint,event:UIEvent) -&gt; UIView; point(inside:CGPoint,event:UIEvent)-&gt;Bool;</p>
<p>点击屏幕 -&gt; UIApplication -&gt; UIWindow -&gt; hitTest-&gt; pointInsinde(倒序遍历子视图 hitTest) -&gt; view</p>
</blockquote>
</li>
<li><p>UIView 绘制流程</p>
<ul>
<li>UIView.setNeedslayout 实际调用 CALayer.setNeedsDisplay。首先在runloop中注册一个Observer监听 线程BeforeWaiting和Exit的事件。执行注册的callback（执行view的drawrect），通过coreAnimation发送到Gpu（view的拼接，纹理的渲染）</li>
<li><p>一般的流程</p>
<p>view.addSubview -&gt; CALayer.drawInContent -&gt; CAlayerDelagate.draw(layer,inContext)</p>
</li>
</ul>
</li>
<li><p>离屏渲染</p>
<ul>
<li>On-Screen Rendering <ul>
<li>意为当前屏幕渲染，指的是GPU的渲染操作是在当前用于显示的屏幕缓冲区中进行。</li>
</ul>
</li>
<li>Off-Screen Rendering <ul>
<li>意为离屏渲染，指的是GPU在当前屏幕缓冲区以外新开辟一个缓冲区进行渲染操作（光栅化，遮罩，阴影，抗锯齿，圆角）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="OC基础"><a href="#OC基础" class="headerlink" title="OC基础"></a>OC基础</h4><h5 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h5><ul>
<li>主要使用体现<ul>
<li>声明私有方法</li>
<li>分解庞大的类文件<ul>
<li>把Framework的私有方法公开</li>
</ul>
</li>
</ul>
</li>
<li>特点<ul>
<li>运行时决定</li>
<li>能够为系统类添加分类</li>
<li>能够添加实例方法、类方法、协议、属性(并非实例变量，get set 方法)</li>
<li></li>
</ul>
</li>
</ul>
<h4 id="Runtime"><a href="#Runtime" class="headerlink" title="Runtime"></a>Runtime</h4><h5 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h5><ul>
<li>主要结构<br><img src="http://s12.sinaimg.cn/orignal/001XHzGhzy7jWM0cUIz4b&amp;690" alt="jgp"></li>
</ul>
<blockquote>
<p> class = objc_class -&gt; 继承objc_object</p>
<p> objc_object (isa指针 )</p>
<p> objc_class(Class superClass, cache_t cache, class_data_bits_t bits)</p>
<p> isa_t 是共用体结构（指针型isa，非指针型isa）</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// objc_object数据结构</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">objc_object</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">isa_t</span> isa;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// isa共用体结构</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">isa_t</span> &#123;</span><br><span class="line">    <span class="keyword">isa_t</span>() &#123; &#125;</span><br><span class="line">    <span class="keyword">isa_t</span>(<span class="keyword">uintptr_t</span> value) : bits(value) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    Class cls;</span><br><span class="line">    <span class="keyword">uintptr_t</span> bits;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="keyword">uintptr_t</span> nonpointer        : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> has_assoc         : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> has_cxx_dtor      : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> shiftcls          : <span class="number">33</span>; <span class="comment">// MACH_VM_MAX_ADDRESS </span></span><br><span class="line">        <span class="keyword">uintptr_t</span> magic             : <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> weakly_referenced : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> deallocating      : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> has_sidetable_rc  : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">uintptr_t</span> extra_rc          : <span class="number">19</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// objcet_class 结构</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> :</span> objc_object &#123;</span><br><span class="line">    <span class="comment">// Class ISA;</span></span><br><span class="line">    Class superclass;</span><br><span class="line">    <span class="keyword">cache_t</span> cache;             <span class="comment">// formerly cache pointer and vtable hash查找</span></span><br><span class="line">    <span class="keyword">class_data_bits_t</span> bits;    <span class="comment">// class_rw_t * plus custom rr/alloc flags</span></span><br><span class="line">  	<span class="keyword">class_rw_t</span> *data() &#123;</span><br><span class="line">    	<span class="keyword">return</span> bits.data();</span><br><span class="line">  	&#125;</span><br><span class="line">  	<span class="function"><span class="keyword">void</span> <span class="title">setData</span><span class="params">(<span class="keyword">class_rw_t</span> *newData)</span> </span>&#123;</span><br><span class="line">      bits.setData(newData);</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 存放 实例方法，属性名</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">class_rw_t</span> &#123;</span></span><br><span class="line">  <span class="keyword">uint32_t</span> flags;</span><br><span class="line">  <span class="keyword">uint32_t</span> version;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">class_ro_t</span> *ro; 		<span class="comment">// 成员信息</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">method_array_t</span> methods;		<span class="comment">//方法列表</span></span><br><span class="line">  <span class="keyword">property_array_t</span> properties;	<span class="comment">//属性列表</span></span><br><span class="line">  <span class="keyword">protocol_array_t</span> protocols;	<span class="comment">//协议列表</span></span><br><span class="line">  </span><br><span class="line">  Class firstSubclass;</span><br><span class="line">  Class nextSiblingClass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 存放 成员变量信息</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">class_ro_t</span> &#123;</span></span><br><span class="line">    <span class="keyword">uint32_t</span> flags;</span><br><span class="line">    <span class="keyword">uint32_t</span> instanceStart;</span><br><span class="line">    <span class="keyword">uint32_t</span> instanceSize;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">uint8_t</span> * ivarLayout;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * name; 				<span class="comment">// 类名</span></span><br><span class="line">    <span class="keyword">method_list_t</span> * baseMethodList;</span><br><span class="line">    <span class="keyword">protocol_list_t</span> * baseProtocols;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">ivar_list_t</span> * ivars; 		<span class="comment">//定义类的成员变量</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">uint8_t</span> * weakIvarLayout;</span><br><span class="line">    <span class="keyword">property_list_t</span> *baseProperties;	<span class="comment">//属性列表</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">method_list_t</span> *baseMethods() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> baseMethodList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="消息转发"><a href="#消息转发" class="headerlink" title="消息转发"></a>消息转发</h5><p><img src="http://s4.sinaimg.cn/orignal/001XHzGhzy7jWMzuTOr53&amp;690" alt=""></p>

            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/iOS进阶学习/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/iOS进阶学习/" title="iOS进阶学习">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章 -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/iOS/">iOS</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="https://Alexzzn.github.io/2018/07/18/iOS/Promise/">
    		Promise
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2018-07-18T09:57:26.483Z">2018-07-18</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>TODO://</p>
<p>RWPromiseKit</p>
<p><a href="http://blog.dianqk.org/2016/08/22/rxswift-vs-promisekit/" target="_blank" rel="noopener">promise介绍</a></p>

            
            <p class="more">
                <a href="https://Alexzzn.github.io/2018/07/18/iOS/Promise/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img="">
            <a href="https://Alexzzn.github.io/2018/07/18/iOS/Promise/" title="Promise">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图" >
                
            </a>
        </div>
    </div>
</article>

    

    
    <nav class="page-navigator">
        <a class="extend prev" rel="prev" href="/categories/iOS/">前一页</a><a class="page-number" href="/categories/iOS/">1</a><span class="page-number current">2</span><a class="page-number" href="/categories/iOS/page/3/">3</a><a class="page-number" href="/categories/iOS/page/4/">4</a><a class="page-number" href="/categories/iOS/page/5/">5</a><a class="extend next" rel="next" href="/categories/iOS/page/3/">后一页</a>
    </nav>
    


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/Android/">Android</a>
        <span class="badge">(14)</span>
    </li>
    
    <li>
        <a href="/categories/Server/">Server</a>
        <span class="badge">(9)</span>
    </li>
    
    <li>
        <a href="/categories/Web/">Web</a>
        <span class="badge">(21)</span>
    </li>
    
    <li>
        <a href="/categories/iOS/">iOS</a>
        <span class="badge">(45)</span>
    </li>
    
    <li>
        <a href="/categories/系统相关/">系统相关</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/编程/">编程</a>
        <span class="badge">(4)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="http://blog.sina.com.cn/u/1825875765" target="_blank" title="网络安全博客">Haoren博客</a>
        </li>
    
        <li>
            <a href="http://blog.csdn.net/yeweiouyang" target="_blank" title="技术博客">Maxwell博客</a>
        </li>
    
        <li>
            <a href="http://xuanzh.cc/" target="_blank" title="技术博客">朱旋个人博客</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2018
    

    <a href="/">Jelon Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>